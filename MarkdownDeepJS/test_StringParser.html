<!DOCTYPE html >
<html>
<head>
  <title>JavaScript unit test file</title>
  <link rel="stylesheet" href="/js/unittest.css" type="text/css" />
  <script src="/js/jsunittest.js" type="text/javascript"></script>

  <script src="../js/MarkdownDeep.js" type="text/javascript"></script>
  
</head>
<body>

<div id="content">

  <div id="header">
    <h1>MarkdownDeep unit test file</h1>
    <p>
      This file tests <strong>MarkdownDeep.StringParser</strong>.
    </p>
  </div>

  <!-- Log output (one per Runner, via {testLog: "testlog"} option)-->
  <div id="testlog"></div>
  
  <!-- Put sample/test html here -->
  <div id="sample">
  </div>
</div>

<script type="text/javascript">
// <![CDATA[
  new Test.Unit.Runner({
    setup: function() {
		this.p=new MarkdownDeep.StringParser();
    },
    
    teardown: function() {
		this.p=null;
    },
    
    testEmpty: function() { with(this) {
		p.reset("");
		assertEqual(p.bof(), true);
		assertEqual(p.eof(), true);
    }},
    
    testBofEof: function() { with(this) {
		p.reset("Hello");
		assertEqual(p.bof(), true);
		assertEqual(p.eof(), false);
		p.position=5;
		assertEqual(p.bof(), false);
		assertEqual(p.eof(), true);
    }},
    
    testCurrent : function() { with(this) {
		p.reset("Hello");
		assertEqual("H", p.current());
		p.SkipForward(1);
		assertEqual("e", p.current());
    }},
    
    testRemainder : function() { with(this) {
		p.reset("Hello");
		assertEqual("Hello", p.remainder());
		p.SkipForward(3);
		assertEqual("lo", p.remainder());
		p.SkipForward(100);
		assertEqual("", p.remainder());
    }},
    
    testSkipToEof : function() { with(this) {
		p.reset("Hello\nWorld");
		p.SkipToEof();
		assertEqual(11, p.position);
    }},

    testEol : function() { with(this) {
		p.reset("Hello\nWorld");

		p.SkipEol();
		assertEqual(0, p.position);
		
		p.SkipToEol();
		assertEqual(5, p.position);
		
		p.SkipEol();
		assertEqual(6, p.position);
		
		p.SkipToEol();
		assertEqual(11, p.position);
		
		p.position=0;
		p.SkipToNextLine();
		assertEqual(6, p.position);
    }},
    
    
    testCharAtOffset : function() { with(this) {
		p.reset("01234");
		p.position=2;
		
		assertEqual(p.CharAtOffset(0), '2');
		
		assertEqual(p.CharAtOffset(-1), '1');
		assertEqual(p.CharAtOffset(-2), '0');
		assertUndefined(p.CharAtOffset(-3));
		assertUndefined(p.CharAtOffset(-30));
		
		assertEqual(p.CharAtOffset(1), '3');
		assertEqual(p.CharAtOffset(2), '4');
		assertUndefined(p.CharAtOffset(3));
		assertUndefined(p.CharAtOffset(30));
    }},
    
    testSkipChar : function() { with(this) {
		p.reset("Hello");

		assertEqual(true, p.SkipChar("H"));
		assertEqual(1, p.position);
		
		assertEqual(false, p.SkipChar("X"));
		assertEqual(1, p.position);
		
		p.position=5;
		assertEqual(false, p.SkipChar("X"));
		assertEqual(5, p.position);
	}},    

    testSkipString : function() { with(this) {
		p.reset("Hello World");

		assertEqual(true, p.SkipString("Hello"));
		assertEqual(5, p.position);
		
		assertEqual(false, p.SkipString("X"));
		assertEqual(5, p.position);
		
		assertEqual(false, p.SkipString(" World+++"));
		assertEqual(5, p.position);
	}},    
	
	
    
    testSkipWhitespace: function() { with(this) {
		p.reset("   Hello    World   ");
		assertEqual(true, p.SkipWhitespace());
		assertEqual(3, p.position);
		assertEqual(false, p.SkipWhitespace());
		assertEqual(3, p.position);
		p.SkipString("Hello");
		assertEqual(true, p.SkipWhitespace());
		assertEqual(12, p.position);
		p.SkipToEof();
		assertEqual(false, p.SkipWhitespace());
    }},
    
    testSkipLinespace : function() { with(this) {
		p.reset("   Hello  \nWorld");
		
		assertEqual(true, p.SkipLinespace());
		assertEqual(3, p.position);
		
		p.SkipString("Hello");
		assertEqual(true, p.SkipLinespace());
		assertEqual(10, p.position);
		
		assertEqual(false, p.SkipLinespace());
		assertEqual(10, p.position);
		
		p.SkipEol();
		assertEqual(false, p.SkipLinespace());
		
		p.SkipToEof();
		assertEqual(false, p.SkipLinespace());
		assertEqual(true, p.eof());
    }},

    testFind : function() { with(this) {
		p.reset("Hello World");
		
		assertEqual(true, p.Find("World"));
		assertEqual(6, p.position);
		
		assertEqual(false, p.Find("blah"));
		assertEqual(11, p.position);
    }},

    testMarkAndExtract : function() { with(this) {
		p.reset("Hello World Again");
		
		p.Find("World");
		p.Mark();
		p.SkipString("World");
		
		assertEqual("World", p.Extract());
    }},

    testSkipIdentifier : function() { with(this) {
    
		p.reset("ident ident2 ident_3 3not !");
		
		assertEqual(true, p.SkipIdentifier());
		assertEqual(5, p.position);
		
		p.SkipWhitespace();
		assertEqual(true, p.SkipIdentifier());
		assertEqual(12, p.position);
		
		p.SkipWhitespace();
		assertEqual(true, p.SkipIdentifier());
		assertEqual(20, p.position);
		
		p.SkipWhitespace();
		assertEqual(false, p.SkipIdentifier());
		assertEqual(21, p.position);
    }},
    
    testSkipHtmlIdentity : function() { with(this) {
		p.reset("&amp; &T");
		
		assertEqual(true, p.SkipHtmlEntity());
		assertEqual(5, p.position);
		
		p.SkipWhitespace();
		
		assertEqual(false, p.SkipHtmlEntity());
		assertEqual(6, p.position);
    }},

    testEscapable : function() { with(this) {
		p.reset("a \\\\ b \\ c ");
		p.Mark();
		
		p.SkipString("a ");
		assertEqual(2, p.position);
		assertEqual(true, p.SkipEscapableChar());
		assertEqual(4, p.position);
		
		p.SkipString(" b ");
		assertEqual(7, p.position);
		assertEqual(false, p.SkipEscapableChar());
		assertEqual(8, p.position);
		
		p.SkipString(" c ");
		assertEqual(11, p.position);
		assertEqual(false, p.SkipEscapableChar());
		assertEqual(11, p.position);
		
		assertEqual(true, p.eof());
		
		var str=p.Extract();
		str=MarkdownDeep.UnescapeString(str);	
		assert(str=="a \\ b \\ c ");
    }},
    
  }); 
// ]]>
</script>
</body>
</html>