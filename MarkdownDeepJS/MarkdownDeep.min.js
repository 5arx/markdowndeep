if(Array.prototype.indexOf==undefined)Array.prototype.indexOf=function(b){for(var a=0;a<this.length;a++)if(this[a]===b)
return a;return -1};var MarkdownDeep=new function(){function v(){this.m_SpanFormatter=new C(this);this.m_SpareBlocks=
new Array();this.m_StringBuilder=new D();this.SafeMode=false;this.ExtraMode=false;this.MarkdownInHtml=false;this.
AutoHeadingIDs=false}var a=v.prototype;a.Transform=function(b){var h=b.indexOf("\r");if(h>=0){var g=b.indexOf("\n");if(g
>=0)if(g<h)b=b.replace(/\n\r/g,"\n");else b=b.replace(/\r\n/g,"\n");b=b.replace(/\r/g,"\n")}this.m_LinkDefinitions=new 
Array();this.m_UsedHeaderIDs=new Array();var e=new w(this,this.MarkdownInHtml).Process(b),i=this.GetStringBuilder();for(
var c=0;c<e.length;c++){var j=e[c];j.Render(this,i)}return i.ToString()};a.AddLinkDefinition=function(b){this.
m_LinkDefinitions[b.id]=b};a.GetLinkDefinition=function(c){var b=this.m_LinkDefinitions[c];if(b==undefined)return null;
else return b};a.MakeUniqueHeaderID=function(i,h,g){if(!this.AutoHeadingIDs)return null;var b=this.m_SpanFormatter.
MakeID(i,h,g);if(!b)b="section";var c=b,e=1;while(this.m_UsedHeaderIDs[c]!=undefined){c=b+"-"+e.toString();e++}this.
m_UsedHeaderIDs[c]=true;return c};a.GetStringBuilder=function(){this.m_StringBuilder.Clear();return this.m_StringBuilder
};a.processSpan=function(c,g,e,b){return this.m_SpanFormatter.Format(c,g,e,b)};function J(b){return b>="0"&&b<="9"}
function O(b){return b>="0"&&b<="9"||b>="a"&&b<="f"||b>="A"&&b<="F"}function K(b){return b>="a"&&b<="z"||b>="A"&&b<="Z"}
function L(b){return b>="a"&&b<="z"||b>="A"&&b<="Z"||b>="0"&&b<="9"}function H(b){return b==" "||b=="\t"||b=="\r"||b==
"\n"}function P(b){return b==" "||b=="\t"}function Q(b){return b=="\r"||b=="\n"}function M(b){return b=="*"||b=="_"}
function N(b){switch(b){case "\\":case "`":case "*":case "_":case "{":case "}":case "[":case "]":case "(":case ")":case 
"#":case "+":case "-":case ".":case "!":case ">":return true}return false}function Y(c,b){if(c.charAt(b)!="&")return -1;
var e=b;b++;if(c.charAt(b)=="#"){b++;if(c.charAt(b)=="x"||c.charAt(b)=="X"){b++;fn_test=O}else fn_test=J}else fn_test=L;
if(fn_test(c.charAt(b))){b++;while(fn_test(c.charAt(b)))b++;if(c.charAt(b)==";"){b++;return b}}b=e;return -1}function X(
c){var b=c.indexOf("\\");if(b<0)return c;var g=new D(),e=0;while(b>=0){if(N(c.charAt(b+1))){if(b>e)g.Append(c.substr(e,b
-e));e=b+1}b=c.indexOf("\\",b+1)}if(e<c.length)g.Append(c.substr(e,c.length-e));return g.ToString()}function V(c){var b=
0,e=c.length;while(b<e&&H(c.charAt(b)))b++;while(e-1>b&&H(c.charAt(b-1)))b--;return c.substr(b,e-b)}function R(c){var b=
c.indexOf("@");if(b<0)return false;var e=c.lastIndexOf(".");if(e<b)return false;return true}function U(b){b=b.
toLowerCase();if(b.substr(0,7)=="http://")return true;if(b.substr(0,8)=="https://")return true;if(b.substr(0,6)==
"ftp://")return true;if(b.substr(0,7)=="file://")return true;return false}function S(c){if(!c)return false;if(!K(c.
charAt(0)))return false;for(var e=0;e<c.length;e++){var b=c.charAt(e);if(L(b)||b=="_"||b=="-"||b==":"||b==".")continue;
return false}return true}function W(c,e,i){var b=i-1;while(b>=e&&H(c.charAt(b)))b--;if(b<e||c.charAt(b)!="}")return null
;var j=b;b--;while(b>=e&&c.charAt(b)!="{")b--;if(b<e||c.charAt(b+1)!="#")return null;var g=b+2,h=c.substr(g,j-g);if(!S(h
))return null;while(b>e&&H(c.charAt(b-1)))b--;return {id:h,end:b}}function D(){this.content=new Array()}a=D.prototype;a.
Append=function(b){if(b)this.content.push(b)};a.Clear=function(){this.content.length=0};a.ToString=function(){
return this.content.join("")};a.HtmlRandomize=function(c){var g=c.length;for(var b=0;b<g;b++){var e=Math.random();if(e>
0.90&&c.charAt(b)!="@")this.Append(c.charAt(b));else if(e>0.45){this.Append("&#");this.Append(c.charCodeAt(b).toString()
);this.Append(";")}else{this.Append("&#x");this.Append(c.charCodeAt(b).toString(16));this.Append(";")}}};a.HtmlEncode=
function(e,g,i){var h=g+i,b=g;for(var c=g;c<h;c++)switch(e.charAt(c)){case "&":if(c>b)this.Append(e.substr(b,c-b));this.
Append("&amp;");b=c+1;break;case "<":if(c>b)this.Append(e.substr(b,c-b));this.Append("&lt;");b=c+1;break;case ">":if(c>b
)this.Append(e.substr(b,c-b));this.Append("&gt;");b=c+1;break;case '"':if(c>b)this.Append(e.substr(b,c-b));this.Append(
"&quot;");b=c+1;break}if(c>b)this.Append(e.substr(b,c-b))};a.SmartHtmlEncodeAmpsAndAngles=function(e,g,j){var i=g+j,c=g;
for(var b=g;b<i;b++)switch(e.charAt(b)){case "&":var h=Y(e,b);if(h<0){if(b>c)this.Append(e.substr(c,b-c));this.Append(
"&amp;");c=b+1}else b=h-1;break;case "<":if(b>c)this.Append(e.substr(c,b-c));this.Append("&lt;");c=b+1;break;case ">":
if(b>c)this.Append(e.substr(c,b-c));this.Append("&gt;");c=b+1;break;case '"':if(b>c)this.Append(e.substr(c,b-c));this.
Append("&quot;");c=b+1;break}if(b>c)this.Append(e.substr(c,b-c))};a.SmartHtmlEncodeAmps=function(e,g,j){var i=g+j,c=g;
for(var b=g;b<i;b++)switch(e.charAt(b)){case "&":var h=Y(e,b);if(h<0){if(b>c)this.Append(e.substr(c,b-c));this.Append(
"&amp;");c=b+1}else b=h-1;break}if(b>c)this.Append(e.substr(c,b-c))};a.HtmlEncodeAndConvertTabsToSpaces=function(e,h,j){
var i=h+j,b=h,g=0;for(var c=h;c<i;c++){switch(e.charAt(c)){case "\t":if(c>b)this.Append(e.substr(b,c-b));b=c+1;this.
Append(" ");g++;while(g%4!=0){this.Append(" ");g++}g--;break;case "\r":case "\n":if(c>b)this.Append(e.substr(b,c-b));
this.Append("\n");b=c+1;continue;case "&":if(c>b)this.Append(e.substr(b,c-b));this.Append("&amp;");b=c+1;break;case "<":
if(c>b)this.Append(e.substr(b,c-b));this.Append("&lt;");b=c+1;break;case ">":if(c>b)this.Append(e.substr(b,c-b));this.
Append("&gt;");b=c+1;break;case '"':if(c>b)this.Append(e.substr(b,c-b));this.Append("&quot;");b=c+1;break}g++}if(c>b)
this.Append(e.substr(b,c-b))};function E(){this.reset.apply(this,arguments)}a=E.prototype;a.bof=function(){return this.
position==this.start};a.eof=function(){return this.position>=this.end};a.eol=function(){if(this.position>=this.end)
return true;var b=this.buf.charAt(this.position);return b=="\r"||b=="\n"||b==undefined||b==""};a.reset=function(){this.
buf=arguments.length>0?arguments[0]:null;this.start=arguments.length>1?arguments[1]:0;this.end=arguments.length>2?this.
start+arguments[2]:this.buf==null?0:this.buf.length;this.position=this.start;this.charset_offsets={}};a.current=function
(){if(this.position>=this.end)return "\x00";return this.buf.charAt(this.position)};a.remainder=function(){return this.
buf.substr(this.position)};a.SkipToEof=function(){this.position=this.end};a.SkipForward=function(b){this.position+=b};a.
SkipToEol=function(){this.position=this.buf.indexOf("\n",this.position);if(this.position<0)this.position=this.end};a.
SkipEol=function(){var b=this.position;if(this.buf.charAt(this.position)=="\r")this.position++;if(this.buf.charAt(this.
position)=="\n")this.position++;return this.position!=b};a.SkipToNextLine=function(){this.SkipToEol();this.SkipEol()};a.
CharAtOffset=function(b){if(this.position+b>=this.end)return "\x00";return this.buf.charAt(this.position+b)};a.SkipChar=
function(b){if(this.buf.charAt(this.position)==b){this.position++;return true}return false};a.SkipString=function(b){if(
this.buf.substr(this.position,b.length)==b){this.position+=b.length;return true}return false};a.SkipWhitespace=function(
){var c=this.position;while(true){var b=this.buf.charAt(this.position);if(b!=" "&&b!="\t"&&b!="\r"&&b!="\n")break;
this.position++}return this.position!=c};a.SkipLinespace=function(){var c=this.position;while(true){var b=this.buf.
charAt(this.position);if(b!=" "&&b!="\t")break;this.position++}return this.position!=c};a.FindRE=function(c){c.lastIndex
=this.position;var b=c.exec(this.buf);if(b==null){this.position=this.end;return false}if(b.index+b[0].length>this.end){
this.position=this.end;return false}this.position=b.index;return true};a.FindOneOf=function(g){var c=-1;for(var e in g){
var b=g[e];if(b==null){b={};b.searched_from=-1;b.found_at=-1;g[e]=b}if(b.searched_from==-1||this.position<b.
searched_from||this.position>=b.found_at&&b.found_at!=-1){b.searched_from=this.position;b.found_at=this.buf.indexOf(e,
this.position)}if(c==-1||b.found_at<c)c=b.found_at}if(c==-1){c=this.end;return false}a.position=c;return true};a.Find=
function(b){this.position=this.buf.indexOf(b,this.position);if(this.position<0){this.position=this.end;return false}
return true};a.Mark=function(){this.mark=this.position};a.Extract=function(){if(this.mark>=this.position)return "";else 
return this.buf.substr(this.mark,this.position-this.mark)};a.SkipIdentifier=function(){var b=this.buf.charAt(this.
position);if(b>="a"&&b<="z"||b>="A"&&b<="Z"||b=="_"){this.position++;while(true){var b=this.buf.charAt(this.position);
if(b>="a"&&b<="z"||b>="A"&&b<="Z"||b=="_"||b>="0"&&b<="9")this.position++;else return true}}return false};a.
SkipHtmlEntity=function(){if(this.buf.charAt(this.position)!="&")return false;var b=Y(this.buf,this.position);if(b<0)
return false;this.position=b;return true};a.SkipEscapableChar=function(){if(this.buf.charAt(this.position)=="\\"&&N(this
.buf.charAt(this.position+1))){this.position+=2;return true}else{if(this.position<this.end)this.position++;return false}
};function n(b){this.name=b;this.attributes={};this.flags=0}a=n.prototype;a.attributes=null;a.closed=false;a.closing=
false;a.attributeCount=function(){if(!this.attributes)return 0;var b=0;for(var c in this.attributes)b++;return b};a.
get_Flags=function(){if(this.flags==0){this.flags=Z[this.name.toLowerCase()];if(this.flags==undefined)this.flags=2}
return this.flags};a.IsSafe=function(){var c=this.name.toLowerCase();if(!I[c])return false;var b=G[c];if(!b)return this.
attributeCount()==0;if(!this.attributes)return true;for(var e in this.attributes)if(!b[e.toLowerCase()])return false;if(
this.attributes["href"])if(!n.IsSafeUrl(this.attributes["href"]))return false;if(this.attributes["src"])if(!n.IsSafeUrl(
this.attributes["src"]))return false;return true};a.RenderOpening=function(b){b.Append("<");b.Append(this.name);for(var 
c in this.m_attributes){b.Append(" ");b.Append(c);b.Append('="');b.Append(this.m_attributes[c]);b.Append('"')}b.Append(
">\n")};a.RenderClosing=function(b){b.Append("</");b.Append(this.name);b.Append(">\n")};n.IsSafeUrl=function(b){b=b.
toLowerCase();return b.substr(0,7)=="http://"||b.substr(0,8)=="https://"||b.substr(0,6)=="ftp://"};n.Parse=function(b){
var e=b.position,c=this.ParseHelper(b);if(c!=null)return c;b.position=e;return null};n.ParseHelper=function(b){if(b.
current()!="<")return null;b.SkipForward(1);if(b.SkipString("!--")){b.Mark();if(b.Find("-->")){var e=new n("!");e.
attributes["content"]=b.Extract();e.closed=true;b.SkipForward(3);return e}}var h=b.SkipChar("/");b.Mark();if(!b.
SkipIdentifier())return null;var c=new n(b.Extract());c.closing=h;if(h){if(b.current()!=">")return null;b.SkipForward(1)
;return c}while(!b.eof()){b.SkipWhitespace();if(b.SkipString("/>")){c.closed=true;return c}if(b.SkipChar(">"))return c;b
.Mark();if(!b.SkipIdentifier())return null;var g=b.Extract();b.SkipWhitespace();if(!b.SkipChar("="))return null;b.
SkipWhitespace();if(b.SkipChar('"')){b.Mark();if(!b.Find('"'))return null;c.attributes[g]=b.Extract();b.SkipForward(1)}
else{b.Mark();while(!b.eof()&&!H(b.current())&&b.current()!=">"&&b.current()!="/")b.SkipForward(1);if(!b.eof())c.
attributes[g]=b.Extract()}}return null};var I={b:1,blockquote:1,code:1,dd:1,dt:1,dl:1,del:1,em:1,h1:1,h2:1,h3:1,h4:1,h5:
1,h6:1,i:1,kbd:1,li:1,ol:1,ul:1,p:1,pre:1,s:1,sub:1,sup:1,strong:1,strike:1,img:1,a:1},G={a:{href:1,title:1},img:{src:1,
width:1,height:1,alt:1,title:1}},d=1,k=2,s=4,f=8,Z={p:d|f,div:d,h1:d|f,h2:d|f,h3:d|f,h4:d|f,h5:d|f,h6:d|f,blockquote:d,
pre:d,table:d,dl:d,ol:d,ul:d,form:d,fieldset:d,iframe:d,script:d|k,noscript:d|k,math:d|k,ins:d|k,del:d|k,img:d|k,li:f,dd
:f,dt:f,td:f,th:f,legend:f,address:f,hr:d|s,"!":d|s};delete d;delete k;delete s;function o(c,e,b){this.id=c;this.url=e;
if(b==undefined)this.title=null;else this.title=b}a=o.prototype;a.RenderLink=function(e,b,c){if(this.url.substr(0,7).
toLowerCase()=="mailto:"){b.Append('<a href="');b.HtmlRandomize(this.url);b.Append('"');if(this.title){b.Append(
' title="');b.SmartHtmlEncodeAmpsAndAngles(this.title,0,this.title.length);b.Append('"')}b.Append(">");b.HtmlRandomize(c
);b.Append("</a>")}else{b.Append('<a href="');b.SmartHtmlEncodeAmpsAndAngles(this.url,0,this.url.length);b.Append('"');
if(this.title){b.Append(' title="');b.SmartHtmlEncodeAmpsAndAngles(this.title,0,this.title.length);b.Append('"')}b.
Append(">");b.Append(c);b.Append("</a>")}};a.RenderImg=function(e,b,c){b.Append('<img src="');b.
SmartHtmlEncodeAmpsAndAngles(this.url,0,this.url.length);b.Append('"');if(c){b.Append(' alt="');b.
SmartHtmlEncodeAmpsAndAngles(c,0,c.length);b.Append('"')}if(this.title){b.Append(' title="');b.
SmartHtmlEncodeAmpsAndAngles(this.title,0,this.title.length);b.Append('"')}b.Append(" />")};o.ParseLinkDefinition=
function(b){var e=b.position,c=o.ParseLinkDefinitionInternal(b);if(c==null)b.position=e;return c};o.
ParseLinkDefinitionInternal=function(b){b.SkipWhitespace();if(!b.SkipChar("["))return null;b.Mark();if(!b.Find("]"))
return null;var c=b.Extract();if(c.length==0)return null;if(!b.SkipString("]:"))return null;var e=this.ParseLinkTarget(b
,c);b.SkipLinespace();if(!b.eol())return null;return e};o.ParseLinkTarget=function(b,g){b.SkipWhitespace();if(b.eol())
return null;var c=new o(g);if(b.SkipChar("<")){b.Mark();while(b.current()!=">"){if(b.eof())return null;b.
SkipEscapableChar()}var p=b.Extract();if(!b.SkipChar(">"))return null;c.url=X(V(p));b.SkipWhitespace()}else{b.Mark();
var i=1;while(!b.eol()){var h=b.current();if(H(h))break;if(g==null)if(h=="(")i++;else if(h==")"){i--;if(i==0)break}b.
SkipEscapableChar()}c.url=X(V(b.Extract()))}b.SkipLinespace();if(b.current()==")")return c;var j=b.eol(),l=b.position;
if(b.eol()){b.SkipEol();b.SkipLinespace()}var e;switch(b.current()){case "'":case '"':e=b.current();break;case "(":e=")"
;break;default:if(j){b.position=l;return c}else return null}b.SkipForward(1);b.Mark();while(true){if(b.eol())return null
;if(b.current()==e){if(e!=")"){var m=b.position;b.SkipForward(1);b.SkipLinespace();if(g==null&&b.current()!=")"||g!=null
&&!b.eol())continue;b.position=m}break}b.SkipEscapableChar()}c.title=X(b.Extract());b.SkipForward(1);return c};function 
T(b,c){this.def=b;this.link_text=c}function aa(e,c,b){this.type=e;this.startOffset=c;this.length=b;this.data=null}
function C(b){this.m_Markdown=b;this.m_Scanner=new E();this.m_SpareTokens=new Array();this.DisableLinks=false}a=C.
prototype;a.Format=function(g,e,i,h){this.m_Scanner.reset(e,i,h);var b=this.Tokenize();if(b==null)g.HtmlEncode(e,i,h);
else{this.RenderTokens(g,e,b);for(var c=0;c<b.length;c++)this.FreeToken(b[c])}};a.FormatDirect=function(c){var b=new D()
;this.Format(b,c,0,c.length);return b.ToString()};a.MakeID=function(i,m,l){var b=this.m_Scanner;b.reset(i,m,l);var j=
this.Tokenize(),c=new D();if(j==null)c.Append(i.substr(m,l));else for(var h=0;h<j.length;h++){var g=j[h];switch(g.type){
case 0:c.Append(i.substr(g.startOffset,g.length));break;case 9:c.Append(g.data.link_text);break}}b.reset(c.ToString());
while(!b.eof()){if(K(b.current()))break;b.SkipForward(1)}c.Clear();while(!b.eof()){var e=b.current();if(L(e)||e=="_"||e
=="-"||e==".")c.Append(e.toLowerCase());else if(e==" ")c.Append("-");else if(Q(e)){c.Append("-");b.SkipEol();continue}b.
SkipForward(1)}return c.ToString()};a.RenderTokens=function(b,g,j){var l=j.length;for(var h=0;h<l;h++){var c=j[h];
switch(c.type){case 0:b.HtmlEncode(g,c.startOffset,c.length);break;case 1:b.SmartHtmlEncodeAmps(g,c.startOffset,c.length
);break;case 2:case 11:case 12:case 13:b.Append(g.substr(c.startOffset,c.length));break;case 8:b.Append("<br />\n");
break;case 3:b.Append("<em>");break;case 4:b.Append("</em>");break;case 5:b.Append("<strong>");break;case 6:b.Append(
"</strong>");break;case 7:b.Append("<code>");b.HtmlEncode(g,c.startOffset,c.length);b.Append("</code>");break;case 9:
var e=c.data,i=new C(this.m_Markdown);i.DisableLinks=true;e.def.RenderLink(this.m_Markdown,b,i.FormatDirect(e.link_text)
);break;case 10:var e=c.data;e.def.RenderImg(this.m_Markdown,b,e.link_text);break}}};a.Tokenize=function(){var b=this.
m_Scanner,g=null,i=null,p=/[\*\_\`\[\!\<\&\ \\]/g,h=b.position;while(!b.eof()){if(!b.FindRE(p))break;var j=b.position,c=
null;switch(b.current()){case "*":case "_":c=this.CreateEmphasisMark();switch(c.type){case 13:case 11:case 12:if(i==null
)i=new Array();i.push(c);break}break;case "`":c=this.ProcessCodeSpan();break;case "[":case "!":var m=b.position;c=this.
ProcessLinkOrImage();if(c==null)b.position=m;break;case "<":var e=b.position,l=n.Parse(b);if(l!=null)if(!this.m_Markdown
.SafeMode||l.IsSafe())c=this.CreateToken(1,e,b.position-e);else b.position=e;else{b.position=e;c=this.ProcessAutoLink();
if(c==null)b.position=e}break;case "&":var e=b.position;if(b.SkipHtmlEntity())c=this.CreateToken(2,e,b.position-e);break
;case " ":if(b.CharAtOffset(1)==" "&&Q(b.CharAtOffset(2))){b.SkipForward(2);if(!b.eof()){b.SkipEol();c=this.CreateToken(
8,j,0)}}break;case "\\":if(N(b.CharAtOffset(1))){c=this.CreateToken(0,b.position+1,1);b.SkipForward(2)}break}if(c!=null)
{if(g==null)g=new Array();if(j>h)g.push(this.CreateToken(0,h,j-h));g.push(c);h=b.position}else b.SkipForward(1)}if(g==
null)return null;if(b.position>h)g.push(this.CreateToken(0,h,b.position-h));if(i!=null)this.ResolveEmphasisMarks(g,i);
return g};a.CreateEmphasisMark=function(){var b=this.m_Scanner,e=b.current(),j=e=="*"?"_":"*",c=b.position;if(b.bof()||H
(b.CharAtOffset(-1))){while(M(b.current()))b.SkipForward(1);if(b.eof()||H(b.current()))return this.CreateToken(2,c,b.
position-c);b.position=c}while(M(b.CharAtOffset(-1)))b.SkipForward(-1);var h=b.bof()||H(b.CharAtOffset(-1));b.position=c
;while(b.current()==e)b.SkipForward(1);var i=b.position-c;while(M(b.CharAtOffset(1)))b.SkipForward(1);var g=b.eof()||H(b
.CharAtOffset(1));b.position=c+i;if(h)return this.CreateToken(11,c,b.position-c);if(g)return this.CreateToken(12,c,b.
position-c);return this.CreateToken(13,c,b.position-c)};a.SplitMarkToken=function(h,g,b,c){var e=this.CreateToken(b.type
,b.startOffset+c,b.length-c);b.length=c;g.splice(g.indexOf(b)+1,0,e);h.splice(h.indexOf(b)+1,0,e);return e};a.
ResolveEmphasisMarks=function(m,b){var l=this.m_Scanner.buf,i=true;while(i){i=false;for(var h=0;h<b.length;h++){var c=b[
h];if(c.type!=11&&c.type!=13)continue;for(var j=h+1;j<b.length;j++){var g=b[j];if(g.type!=12&&g.type!=13)break;if(l.
charAt(c.startOffset)!=l.charAt(g.startOffset))continue;var e=Math.min(c.length,g.length);if(e>=3)e=e%2==1?1:2;if(c.
length>e){c=this.SplitMarkToken(m,b,c,c.length-e);h--}if(g.length>e)this.SplitMarkToken(m,b,g,e);c.type=e==1?3:5;g.type=
e==1?4:6;b.splice(b.indexOf(c),1);b.splice(b.indexOf(g),1);i=true;break}}}};a.ProcessAutoLink=function(){if(this.
DisableLinks)return null;var c=this.m_Scanner;c.SkipForward(1);c.Mark();while(!c.eof()){var h=c.current();if(H(h))break;
if(h==">"){var b=X(c.Extract()),e=null;if(R(b)){var g;if(b.toLowerCase().substr(0,7)=="mailto:")g=b.substr(7);else{g=b;b
="mailto:"+b}e=new T(new o("auto",b,null),g)}else if(U(b))e=new T(new o("auto",b,null),b);if(e!=null){c.SkipForward(1);
return this.CreateDataToken(9,e)}return null}c.SkipEscapableChar()}return null};a.ProcessLinkOrImage=function(){if(this.
DisableLinks)return null;var b=this.m_Scanner,q=b.SkipChar("!")?10:9;if(!b.SkipChar("["))return null;b.Mark();var h=1;
while(!b.eof()){var l=b.current();if(l=="[")h++;else if(l=="]"){h--;if(h==0)break}b.SkipEscapableChar()}if(b.eof())
return null;var j=X(b.Extract());b.SkipForward(1);var r=b.position;if(b.SkipChar("(")){var p=o.ParseLinkTarget(b,null);
if(p==null)return null;b.SkipWhitespace();if(!b.SkipChar(")"))return null;return this.CreateDataToken(q,new T(p,j))}if(!
b.SkipChar(" "))b.SkipChar("\t");if(b.eol()){b.SkipEol();b.SkipLinespace()}var c=null;if(b.current()=="["){b.SkipForward
(1);b.Mark();if(!b.Find("]"))return null;c=b.Extract();b.SkipForward(1)}else b.position=r;if(!c){c=j;while(true){var i=c
.indexOf("\n");if(i<0)break;var g=i;while(g>0&&H(c.charAt(g-1)))g--;var e=i;while(e<c.length&&H(c.charAt(e)))e++;c=c.
substr(0,g)+" "+c.substr(e)}}var m=this.m_Markdown.GetLinkDefinition(c);if(m==null)return null;return this.
CreateDataToken(q,new T(m,j))};a.ProcessCodeSpan=function(){var b=this.m_Scanner,c=b.position,e=0;while(b.SkipChar("`"))
e++;b.SkipWhitespace();if(b.eof())return this.CreateToken(0,c,b.position-c);var g=b.position;if(!b.Find(b.buf.substr(c,e
)))return this.CreateToken(0,c,b.position-c);var h=b.position+e;while(H(b.CharAtOffset(-1)))b.SkipForward(-1);var i=this
.CreateToken(7,g,b.position-g);b.position=h;return i};a.CreateToken=function(g,e,c){if(this.m_SpareTokens.length!=0){
var b=this.m_SpareTokens.pop();b.type=g;b.startOffset=e;b.length=c;b.data=null;return b}else return new aa(g,e,c)};a.
CreateDataToken=function(e,c){if(this.m_SpareTokens.length!=0){var b=this.m_SpareTokens.pop();b.type=e;b.data=c;return b
}else{var b=new aa(e,0,0);b.data=c;return b}};a.FreeToken=function(b){b.data=null;this.m_SpareTokens.push(b)};function B
(){}a=B.prototype;a.buf=null;a.blockType=0;a.contentStart=0;a.contentLen=0;a.lineStart=0;a.lineLen=0;a.children=null;a.
data=null;a.get_Content=function(){if(this.buf==null)return null;if(this.contentStart==-1)return this.buf;return this.
buf.substr(this.contentStart,this.contentLen)};a.get_CodeContent=function(){var c=new D();for(var b=0;b<this.children.
length;b++){c.Append(this.children[b].get_Content());c.Append("\n")}return c.ToString()};a.RenderChildren=function(e,c){
for(var b=0;b<this.children.length;b++)this.children[b].Render(e,c)};a.ResolveHeaderID=function(e){if(this.data!=null)
return this.data;var c=W(this.buf,this.contentStart,this.get_contentEnd()),b=null;if(c!=null){this.set_contentEnd(c.end)
;b=c.id}else b=e.MakeUniqueHeaderID(this.buf,this.contentStart,this.contentLen);this.data=b;return b};a.Render=function(
c,b){switch(this.blockType){case 0:return;case 12:b.Append("<p>");c.processSpan(b,this.buf,this.contentStart,this.
contentLen);b.Append("</p>\n");break;case 17:c.processSpan(b,this.buf,this.contentStart,this.contentLen);b.Append("\n");
break;case 1:case 2:case 3:case 4:case 5:case 6:if(c.ExtraMode&&!c.SafeMode){b.Append("<h"+(this.blockType-1+1).toString
());var h=this.ResolveHeaderID(c);if(h){b.Append(' id="');b.Append(h);b.Append('">')}else b.Append(">")}else b.Append(
"<h"+(this.blockType-1+1).toString()+">");c.processSpan(b,this.buf,this.contentStart,this.contentLen);b.Append("</h"+(
this.blockType-1+1).toString()+">\n");break;case 14:b.Append("<hr />\n");return;case 10:case 11:b.Append("<li>");c.
processSpan(b,this.buf,this.contentStart,this.contentLen);b.Append("</li>\n");break;case 15:b.Append(this.buf.substr(
this.contentStart,this.contentLen));return;case 16:b.HtmlEncode(this.buf,this.contentStart,this.contentLen);return;case 
18:b.Append("<pre><code>");for(var e=0;e<this.children.length;e++){var g=this.children[e];b.
HtmlEncodeAndConvertTabsToSpaces(g.buf,g.contentStart,g.contentLen);b.Append("\n")}b.Append("</code></pre>\n\n");return;
case 9:b.Append("<blockquote>\n");this.RenderChildren(c,b);b.Append("</blockquote>\n");return;case 19:b.Append("<li>\n")
;this.RenderChildren(c,b);b.Append("</li>\n");return;case 20:b.Append("<ol>\n");this.RenderChildren(c,b);b.Append(
"</ol>\n");return;case 21:b.Append("<ul>\n");this.RenderChildren(c,b);b.Append("</ul>\n");return;case 22:this.data.
RenderOpening(b);this.RenderChildren(c,b);this.data.RenderClosing(b);return;case 23:this.RenderChildren(c,b);return}};a.
RevertToPlain=function(){this.blockType=12;this.contentStart=this.lineStart;this.contentLen=this.lineLen};a.
get_contentEnd=function(){return this.contentStart+this.contentLen};a.set_contentEnd=function(b){this.contentLen=b-this.
contentStart};a.get_leadingSpaces=function(){var c=0;for(var b=this.lineStart;b<this.lineStart+this.lineLen;b++)if(this.
buf.charAt(b)==" ")c++;else break;return c};a.CopyFrom=function(b){this.blockType=b.blockType;this.buf=b.buf;this.
contentStart=b.contentStart;this.contentLen=b.contentLen;this.lineStart=b.lineStart;this.lineLen=b.lineLen;return this};
function w(b,c){this.m_Markdown=b;this.m_parentType=0;this.m_bMarkdownInHtml=c}a=w.prototype;a.Process=function(c){var b
=new E(c);return this.ScanLines(b)};a.ProcessRange=function(g,e,b){var c=new E(g,e,b);return this.ScanLines(c)};a.
ScanLines=function(i){var e=new Array(),b=new Array();while(!i.eof()){var c=this.EvaluateLine(i);if(c.blockType==7||c.
blockType==8){if(b.length>0){var g=b.pop();this.CollapseLines(e,b);if(g.blockType!=0){g.RevertToPlain();g.blockType=c.
blockType==7?1:2;e.push(g);continue}}if(c.blockType==7){c.RevertToPlain();b.push(c)}else if(c.contentLen>=3){c.blockType
=14;e.push(c)}else{c.RevertToPlain();b.push(c)}continue}var h=b.length>0?b[0].blockType:0;switch(c.blockType){case 0:
switch(h){case 0:this.FreeBlock(c);break;case 12:this.CollapseLines(e,b);this.FreeBlock(c);break;case 9:case 10:case 11:
case 13:b.push(c);break}break;case 12:switch(h){case 0:case 12:b.push(c);break;case 9:case 10:case 11:var g=b[b.length-1
];if(g.blockType==0){this.CollapseLines(e,b);b.push(c)}else b.push(c);break;case 13:this.CollapseLines(e,b);b.push(c);
break}break;case 13:switch(h){case 0:b.push(c);break;case 12:case 9:var g=b[b.length-1];if(g.blockType==0){this.
CollapseLines(e,b);b.push(c)}else{c.RevertToPlain();b.push(c)}break;case 10:case 11:case 13:b.push(c);break}break;case 9
:if(h!=9)this.CollapseLines(e,b);b.push(c);break;case 10:case 11:switch(h){case 0:b.push(c);break;case 12:case 9:var g=b
[b.length-1];if(g.blockType==0||this.m_parentType==10||this.m_parentType==11){this.CollapseLines(e,b);b.push(c)}else{c.
RevertToPlain();b.push(c)}break;case 10:case 11:if(c.blockType!=h)this.CollapseLines(e,b);b.push(c);break;case 13:this.
CollapseLines(e,b);b.push(c);break}break;default:this.CollapseLines(e,b);e.push(c);break}}this.CollapseLines(e,b);
return e};a.CreateBlock=function(){if(this.m_Markdown.m_SpareBlocks.length>1)return this.m_Markdown.m_SpareBlocks.pop();
else return new B()};a.FreeBlock=function(b){this.m_Markdown.m_SpareBlocks.push(b)};a.FreeBlocks=function(b){for(var c=0
;c<b.length;c++)this.m_Markdown.m_SpareBlocks.push(b[c]);b.length=0};a.RenderLines=function(g){var b=this.m_Markdown.
GetStringBuilder();for(var c=0;c<g.length;c++){var e=g[c];b.Append(e.buf.substr(e.contentStart,e.contentLen));b.Append(
"\n")}return b.ToString()};a.CollapseLines=function(e,b){while(b.length>0&&b[b.length-1].blockType==0)this.FreeBlock(b.
pop());if(b.length==0)return;switch(b[0].blockType){case 12:var c=this.CreateBlock();c.blockType=12;c.buf=b[0].buf;c.
contentStart=b[0].contentStart;c.set_contentEnd(b[b.length-1].get_contentEnd());e.push(c);this.FreeBlocks(b);break;case 
9:var l=this.RenderLines(b),j=new w(this.m_Markdown,this.m_bMarkdownInHtml);j.m_parentType=9;var i=this.CreateBlock();i.
blockType=9;i.children=j.Process(l);this.FreeBlocks(b);e.push(i);break;case 10:case 11:e.push(this.BuildList(b));break;
case 13:var g=this.CreateBlock();g.blockType=18;g.children=new Array();for(var h=0;h<b.length;h++)g.children.push(b[h]);
e.push(g);b.length=0;break}};a.EvaluateLine=function(c){var b=this.CreateBlock();b.lineStart=c.position;b.buf=c.buf;b.
contentStart=c.position;b.contentLen=-1;b.blockType=this.EvaluateLineInternal(c,b);if(b.contentLen<0){c.SkipToEol();b.
contentLen=c.position-b.contentStart}b.lineLen=c.position-b.lineStart;c.SkipEol();return b};a.EvaluateLineInternal=
function(b,c){if(b.eol())return 0;var i=b.position,e=b.current();if(e=="#"){var h=1;b.SkipForward(1);while(b.current()==
"#"){h++;b.SkipForward(1)}if(h>6)h=6;b.SkipWhitespace();c.contentStart=b.position;b.SkipToEol();if(this.m_Markdown.
ExtraMode&&!this.m_Markdown.SafeMode){var l=W(b.buf,c.contentStart,b.position);if(l!=null){c.data=l.id;b.position=l.end}
}while(b.position>c.contentStart&&b.CharAtOffset(-1)=="#")b.SkipForward(-1);while(b.position>c.contentStart&&H(b.
CharAtOffset(-1)))b.SkipForward(-1);c.contentLen=b.position-c.contentStart;b.SkipToEol();return 1+h-1}if(e=="-"||e=="=")
{var j=e;while(b.current()==j)b.SkipForward(1);b.SkipLinespace();if(b.eol())return j=="="?7:8;b.position=i}if(e=="~"&&
this.m_Markdown.ExtraMode){if(this.ProcessFencedCodeBlock(b,c))return c.blockType;b.position=i}var g=-1,q=0;while(!b.eol
()){if(b.current()==" "){if(g<0)q++}else if(b.current()=="\t"){if(g<0)g=b.position}else break;b.SkipForward(1)}if(b.eol(
)){c.contentLen=0;return 0}if(q>=4){c.contentStart=i+4;return 13}if(g>=0&&g-i<4){c.contentStart=g+1;return 13}c.
contentStart=b.position;e=b.current();if(e=="<"){if(this.ScanHtml(b,c))return c.blockType;b.position=c.contentStart}if(e
==">"){if(P(b.CharAtOffset(1))){b.SkipForward(2);c.contentStart=b.position;return 9}b.SkipForward(1);c.contentStart=b.
position;return 9}if(e=="-"||e=="_"||e=="*"){var m=0;while(!b.eol()){var j=b.current();if(b.current()==e){m++;b.
SkipForward(1);continue}if(P(b.current())){b.SkipForward(1);continue}break}if(b.eol()&&m>=3)return 14;b.position=c.
contentStart}if((e=="*"||e=="+"||e=="-")&&P(b.CharAtOffset(1))){b.SkipForward(1);b.SkipLinespace();c.contentStart=b.
position;return 11}if(J(e)){b.SkipForward(1);while(J(b.current()))b.SkipForward(1);if(b.SkipChar(".")&&b.SkipLinespace()
){c.contentStart=b.position;return 10}b.position=c.contentStart}if(e=="["){var p=o.ParseLinkDefinition(b);if(p!=null){
this.m_Markdown.AddLinkDefinition(p);return 0}}return 12};a.GetMarkdownMode=function(c){var b=c.attributes["markdown"];
if(b==undefined)if(this.m_bMarkdownInHtml)return 3;else return 0;delete c.attributes["markdown"];if(b=="1")return (c.
get_Flags()&8)!=0?2:1;if(b=="block")return 1;if(b=="deep")return 3;if(b=="span")return 2;return 4};a.
ProcessMarkdownEnabledHtml=function(b,e,p,l){var g=b.position,j=1,i=false;while(!b.eof()){if(!b.Find("<"))break;var m=b.
position,h=n.Parse(b);if(h==null){b.SkipForward(1);continue}if(this.m_Markdown.SafeMode&&l==4&&!i)if(!h.IsSafe())i=true;
if(h.closed)continue;if(h.name==p.name)if(h.closing){j--;if(j==0){b.SkipLinespace();b.SkipEol();e.blockType=22;e.data=p;
e.contentEnd=b.position;switch(l){case 2:var c=this.CreateBlock();c.buf=b.buf;c.blockType=17;c.contentStart=g;c.
contentLen=m-g;e.children=new Array();e.children.push(c);break;case 1:case 3:var q=new w(this.m_Markdown,l==3);e.
children=q.ProcessRange(b.buf,g,m-g);break;case 4:if(i){e.blockType=16;e.contentEnd=b.position}else{var c=this.
CreateBlock();c.buf=b.buf;c.blockType=15;c.contentStart=g;c.contentLen=m-g;e.children=new Array();e.children.push(c)}
break}return true}}else j++}return false};a.ScanHtml=function(b,c){var j=b.position,h=n.Parse(b);if(h==null)return false
;if(h.closing)return false;var l=false;if(this.m_Markdown.SafeMode&&!h.IsSafe())l=true;var q=h.get_Flags();if((q&1)==0)
return false;if((q&4)!=0||h.closed){b.SkipLinespace();b.SkipEol();c.contentLen=b.position-c.contentStart;c.blockType=l?
16:15;return true}if((q&2)!=0){b.SkipLinespace();if(!b.eol())return false}if(this.m_Markdown.ExtraMode){var m=this.
GetMarkdownMode(h);if(m!=0)return this.ProcessMarkdownEnabledHtml(b,c,h,m)}var i=null,p=1;while(!b.eof()){if(!b.Find("<"
))break;var t=b.position,g=n.Parse(b);if(g==null){b.SkipForward(1);continue}if(this.m_Markdown.SafeMode&&!g.IsSafe())l=
true;if(g.closed)continue;if(!g.closing&&this.m_Markdown.ExtraMode&&!l){var m=this.GetMarkdownMode(g);if(m!=0){var r=
this.CreateBlock();if(this.ProcessMarkdownEnabledHtml(b,r,g,m)){if(i==null)i=new Array();if(t>j){var e=this.CreateBlock(
);e.buf=b.buf;e.blockType=15;e.contentStart=j;e.contentLen=t-j;i.push(e)}i.push(r);j=b.position;continue}else this.
FreeBlock(r)}}if(g.name==h.name&&!g.closed)if(g.closing){p--;if(p==0){b.SkipLinespace();b.SkipEol();if(l){c.blockType=16
;c.contentEnd=b.position;return true}if(i!=null){if(b.position>j){var e=this.CreateBlock();e.buf=b.buf;e.blockType=15;e.
contentStart=j;e.contentLen=b.position-j;i.push(e)}c.blockType=23;c.contentEnd=b.position;c.children=i;return true}c.
blockType=15;c.contentLen=b.position-c.contentStart;return true}}else p++}return 0};a.BuildList=function(c){var l=c[0].
blockType,x=c[0].get_leadingSpaces();for(var b=1;b<c.length;b++){if(c[b].blockType==12&&(c[b-1].blockType==12||c[b-1].
blockType==l)){c[b-1].set_contentEnd(c[b].get_contentEnd());this.FreeBlock(c[b]);c.splice(b,1);b--;continue}if(c[b].
blockType!=13&&c[b].blockType!=0){var u=c[b].get_leadingSpaces();if(u>x){c[b].blockType=13;var y=c[b].get_contentEnd();c
[b].contentStart=c[b].lineStart+u;c[b].set_contentEnd(y)}}}var h=this.CreateBlock();h.blockType=l==11?21:20;h.children=
new Array();for(var b=0;b<c.length;b++){var i=b;while(i>0&&c[i-1].blockType==0)i--;var e=b;while(e<c.length-1&&c[e+1].
blockType!=l)e++;if(i==e)h.children.push(this.CreateBlock().CopyFrom(c[b]));else{var q=false,p=this.m_Markdown.
GetStringBuilder();for(var j=i;j<=e;j++){var m=c[j];p.Append(m.buf.substr(m.contentStart,m.contentLen));p.Append("\n");
if(c[j].blockType==0)q=true}var g=this.CreateBlock();g.blockType=19;var r=new w(this.m_Markdown);r.m_parentType=l;g.
children=r.Process(p.ToString());if(!q)for(var b=0;b<g.children.length;b++){var t=g.children[b];if(t.blockType==12)t.
blockType=17}h.children.push(g)}b=e}this.FreeBlocks(c);c.length=0;return h};a.ProcessFencedCodeBlock=function(b,e){b.
Mark();while(b.current()=="~")b.SkipForward(1);var g=b.Extract();if(g.length<3)return false;b.SkipLinespace();if(!b.eol(
))return false;b.SkipEol();var i=b.position;if(!b.Find(g))return false;if(!Q(b.CharAtOffset(-1)))return false;var h=b.
position;b.SkipForward(g.length);b.SkipLinespace();if(!b.eol())return false;e.blockType=18;e.children=new Array();h--;
var c=this.CreateBlock();c.blockType=13;c.buf=b.buf;c.contentStart=i;c.contentLen=h-i;e.children.push(c);return true};
this.Markdown=v}()